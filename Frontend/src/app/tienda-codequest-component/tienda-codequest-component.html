<div class="super-container">
  <app-sidebar-component></app-sidebar-component>

  <div class="tienda-container">
    <!-- Header Section -->
    <div class="header-section">
      <div class="header-content">
        <div class="breadcrumb">
          <a href="#" class="breadcrumb-link">Inicio</a>
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="9 18 15 12 9 6" />
          </svg>
          <span class="breadcrumb-current">Tienda CodeQuest</span>
        </div>

        <div class="header-main">
          <div class="header-info">
            <h1 class="page-title">
              <svg
                width="32"
                height="32"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"
                />
                <line x1="7" y1="7" x2="7.01" y2="7" />
              </svg>
              Tienda CodeQuest
            </h1>
            <p class="page-subtitle">
              Mejora tu experiencia de aprendizaje con productos exclusivos y poderes especiales
            </p>

            <div class="user-balance-card">
              <div class="balance-info">
                <div class="balance-label">Tus CodeCoins</div>
                <div class="balance-amount">{{ userBalance | number }} CC</div>
              </div>
              <div class="balance-stats">
                <div class="stat">
                  <span class="stat-value">+{{ dailyBonus }}</span>
                  <span class="stat-label">Bonus diario</span>
                </div>
                <div class="stat">
                  <span class="stat-value">{{ streakDays }}</span>
                  <span class="stat-label">Días de racha</span>
                </div>
              </div>
            </div>
          </div>

          <div class="header-actions">
            <div class="action-card premium">
              <h3>Plan Premium</h3>
              <p>Acceso completo a todos los cursos</p>
              <div class="price">$5.99<span>/mes</span></div>
              <button class="action-btn premium-btn" (click)="buyPremiumPlan()">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                  />
                </svg>
                Comprar Ahora
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Navigation Tabs -->
      <div class="tabs-navigation">
        <button
          class="tab-btn"
          [class.active]="activeTab === 'poderes'"
          (click)="setActiveTab('poderes')"
        >
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
          </svg>
          Poderes Especiales
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab === 'productos'"
          (click)="setActiveTab('productos')"
        >
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"
            />
          </svg>
          Productos
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab === 'premium'"
          (click)="setActiveTab('premium')"
        >
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
            />
          </svg>
          Planes Premium
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab === 'cursos'"
          (click)="setActiveTab('cursos')"
        >
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
          </svg>
          Cursos Individuales
        </button>
      </div>

      <!-- Poderes Section -->
      <section class="products-section" *ngIf="activeTab === 'poderes'">
        <h2 class="section-title">Poderes Especiales</h2>
        <p class="section-subtitle">Mejora tu progreso con poderes temporales</p>

        <div class="products-grid">
          <div
            class="product-card"
            *ngFor="let power of powers; let i = index"
            [class.featured]="power.isFeatured"
            [style.animation-delay.ms]="i * 100"
          >
            <div class="product-badge" *ngIf="power.isFeatured">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                />
              </svg>
              Popular
            </div>

            <div class="product-icon" [style.background]="power.color">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"></svg>
            </div>

            <h3 class="product-title">{{ power.name }}</h3>
            <p class="product-description">{{ power.description }}</p>

            <div class="product-details">
              <div class="detail-item">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <polyline points="12 6 12 12 16 14" />
                </svg>
                <span>{{ power.duration }}</span>
              </div>
              <div class="detail-item">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                  <polyline points="14 2 14 8 20 8" />
                  <line x1="16" y1="13" x2="8" y2="13" />
                  <line x1="16" y1="17" x2="8" y2="17" />
                  <polyline points="10 9 9 9 8 9" />
                </svg>
                <span>{{ power.uses }} usos</span>
              </div>
            </div>

            <div class="product-price">
              <span class="price-amount">{{ power.price | number }} CC</span>
              <span class="price-label">CodeCoins</span>
            </div>

            <button
              class="buy-btn"
              [class.owned]="power.owned"
              [class.insufficient]="userBalance < power.price && !power.owned"
              (click)="purchaseItem(power)"
            >
              <span *ngIf="power.owned">Ya Adquirido</span>
              <span *ngIf="!power.owned && userBalance >= power.price">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="9" cy="21" r="1" />
                  <circle cx="20" cy="21" r="1" />
                  <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" />
                </svg>
                Comprar
              </span>
              <span *ngIf="!power.owned && userBalance < power.price">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <line x1="12" y1="8" x2="12" y2="12" />
                  <line x1="12" y1="16" x2="12.01" y2="16" />
                </svg>
                Insuficientes
              </span>
            </button>
          </div>
        </div>
      </section>

      <!-- Productos Section -->
      <section class="products-section" *ngIf="activeTab === 'productos'">
        <h2 class="section-title">Productos Exclusivos</h2>
        <p class="section-subtitle">Artículos especiales para mejorar tu experiencia</p>

        <div class="products-grid">
          <div
            class="product-card"
            *ngFor="let product of products; let i = index"
            [class.featured]="product.isFeatured"
            [style.animation-delay.ms]="i * 100"
          >
            <div class="product-badge" *ngIf="product.isFeatured">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                />
              </svg>
              Nuevo
            </div>

            <div class="product-image">
              <img [src]="product.image" [alt]="product.name" />
            </div>

            <h3 class="product-title">{{ product.name }}</h3>
            <p class="product-description">{{ product.description }}</p>

            <div class="product-details">
              <div class="detail-item" *ngIf="product.type">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"
                  />
                </svg>
                <span>{{ product.type }}</span>
              </div>
              <div class="detail-item" *ngIf="product.rarity">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <polygon
                    points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
                  />
                </svg>
                <span>{{ product.rarity }}</span>
              </div>
            </div>

            <div class="product-price">
              <span class="price-amount">{{ product.price | number }} CC</span>
              <span class="price-label">CodeCoins</span>
            </div>

            <button
              class="buy-btn"
              [class.owned]="product.owned"
              [class.insufficient]="userBalance < product.price && !product.owned"
              (click)="purchaseItem(product)"
            >
              <span *ngIf="product.owned">En Inventario</span>
              <span *ngIf="!product.owned && userBalance >= product.price">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="9" cy="21" r="1" />
                  <circle cx="20" cy="21" r="1" />
                  <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" />
                </svg>
                Comprar
              </span>
              <span *ngIf="!product.owned && userBalance < product.price">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <line x1="12" y1="8" x2="12" y2="12" />
                  <line x1="12" y1="16" x2="12.01" y2="16" />
                </svg>
                Insuficientes
              </span>
            </button>
          </div>
        </div>
      </section>

      <!-- Premium Plans Section -->
      <section class="premium-section" *ngIf="activeTab === 'premium'">
        <h2 class="section-title">Planes Premium</h2>
        <p class="section-subtitle">Acceso completo a toda la plataforma</p>

        <div class="plans-grid">
          <div
            class="plan-card"
            *ngFor="let plan of premiumPlans; let i = index"
            [class.recommended]="plan.recommended"
            [style.animation-delay.ms]="i * 150"
          >
            <div class="plan-header" *ngIf="plan.recommended">
              <div class="recommended-badge">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path
                    d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                  />
                </svg>
                Más Popular
              </div>
            </div>

            <div class="plan-content">
              <h3 class="plan-name">{{ plan.name }}</h3>
              <p class="plan-description">{{ plan.description }}</p>

              <div class="plan-price">
                <div class="price-main">{{ plan.price }}</div>
                <div class="price-period" *ngIf="plan.period">{{ plan.period }}</div>
                <div class="price-savings" *ngIf="plan.savings">{{ plan.savings }}</div>
              </div>

              <ul class="plan-features">
                <li *ngFor="let feature of plan.features">
                  <svg
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polyline points="20 6 9 17 4 12" />
                  </svg>
                  {{ feature }}
                </li>
              </ul>

              <button class="plan-btn" [class.recommended]="plan.recommended">Comprar Plan</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Individual Courses Section -->
      <section class="courses-section" *ngIf="activeTab === 'cursos'">
        <h2 class="section-title">Cursos Individuales</h2>
        <p class="section-subtitle">Compra cursos específicos sin suscripción</p>

        <div class="courses-grid">
          <div
            class="course-card"
            *ngFor="let course of individualCourses; let i = index"
            [style.animation-delay.ms]="i * 80"
          >
            <div class="course-image">
              <img [src]="course.image" [alt]="course.title" />
              <div class="course-overlay">
                <button class="preview-btn">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                    <polygon points="5 3 19 12 5 21 5 3" />
                  </svg>
                </button>
              </div>
            </div>

            <div class="course-content">
              <div class="course-level" [attr.data-level]="course.level">{{ course.level }}</div>
              <h3 class="course-title">{{ course.title }}</h3>
              <p class="course-description">{{ course.description }}</p>

              <div class="course-meta">
                <div class="meta-item">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <circle cx="12" cy="12" r="10" />
                    <polyline points="12 6 12 12 16 14" />
                  </svg>
                  <span>{{ course.duration }}</span>
                </div>
                <div class="meta-item">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                  </svg>
                  <span>{{ course.students | number }} estudiantes</span>
                </div>
              </div>

              <div class="course-price">
                <div class="price-info">
                  <div class="current-price">{{ course.price }}</div>
                  <div class="original-price" *ngIf="course.originalPrice">
                    {{ course.originalPrice }}
                  </div>
                </div>
                <button class="course-buy-btn">Comprar Curso</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Purchase Modal -->
    <div class="modal-overlay" *ngIf="showPurchaseModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Confirmar Compra</h3>
          <button class="modal-close" (click)="closeModal()">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="18" y1="6" x2="6" y2="18" />
              <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
          </button>
        </div>

        <div class="modal-body">
          <div class="purchase-item">
            <div class="item-icon" [style.background]="selectedItem?.color" *ngIf="selectedItem">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"></svg>
            </div>
            <div class="item-info">
              <h4>{{ selectedItem?.name }}</h4>
              <p>{{ selectedItem?.description }}</p>
            </div>
          </div>

          <div class="purchase-details">
            <div class="detail-row">
              <span>Precio:</span>
              <span class="price">{{ selectedItem?.price | number }} CodeCoins</span>
            </div>
            <div class="detail-row">
              <span>Tu saldo:</span>
              <span class="balance">{{ userBalance | number }} CodeCoins</span>
            </div>
            <div class="detail-row total">
              <span>Saldo después:</span>
              <span class="remaining"
                >{{ userBalance - (selectedItem?.price || 0) | number }} CodeCoins</span
              >
            </div>
          </div>
        </div>

        <div class="modal-actions">
          <button class="btn-cancel" (click)="closeModal()">Cancelar</button>
          <button
            class="btn-confirm"
            [class.insufficient]="userBalance < (selectedItem?.price || 0)"
            (click)="confirmPurchase()"
          >
            <span *ngIf="userBalance >= (selectedItem?.price || 0)">Confirmar Compra</span>
            <span *ngIf="userBalance < (selectedItem?.price || 0)">Saldo Insuficiente</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
