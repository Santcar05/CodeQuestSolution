<!-- detalle-curso-component.html -->
<div class="super-container">
  <app-sidebar-component></app-sidebar-component>
  <div class="curso-detalle-container">
    <!-- Hero Section -->
    <div class="hero-section">
      <div class="hero-content">
        <div class="breadcrumb">
          <a href="#" class="breadcrumb-link">Cursos</a>
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="9 18 15 12 9 6" />
          </svg>
          <a href="#" class="breadcrumb-link">{{ course!.category }}</a>
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="9 18 15 12 9 6" />
          </svg>
          <span class="breadcrumb-current">{{ course!.title }}</span>
        </div>

        <div class="hero-main">
          <div class="hero-info">
            <div class="course-badges">
              <span class="level-badge" [attr.data-level]="course!.level">{{ course!.level }}</span>
              <span class="new-badge" *ngIf="course!.isNew">NUEVO</span>
              <span class="trending-badge" *ngIf="course!.isTrending">
                <svg
                  width="14"
                  height="14"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <polyline points="23 6 13.5 15.5 8.5 10.5 1 18" />
                  <polyline points="17 6 23 6 23 12" />
                </svg>
                TENDENCIA
              </span>
            </div>

            <h1 class="course-title">{{ course!.title }}</h1>
            <p class="course-description">{{ course!.description }}</p>

            <div class="course-stats">
              <div class="stat-item">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                  <polygon
                    points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
                  />
                </svg>
                <span class="stat-value">{{ course!.rating }}</span>
              </div>
              <div class="stat-item">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                  <circle cx="9" cy="7" r="4" />
                  <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                  <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                </svg>
                <span class="stat-value">{{ course!.students!.toLocaleString() }}</span>
                <span class="stat-label">estudiantes</span>
              </div>
              <div class="stat-item">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <polyline points="12 6 12 12 16 14" />
                </svg>
                <span class="stat-value">{{ course!.duration }}</span>
                <span class="stat-label">duración</span>
              </div>
              <div class="stat-item">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
                </svg>
                <span class="stat-value">{{ course!.totalPoints }}</span>
                <span class="stat-label">CodeCoins totales</span>
              </div>
            </div>

            <div class="instructor-info">
              <img
                [src]="course!.instructor!.avatar"
                [alt]="course!.instructor!.name"
                class="instructor-avatar"
              />
              <div class="instructor-details">
                <span class="instructor-label">Instructor</span>
                <span class="instructor-name">{{ course!.instructor!.name }}</span>
              </div>
            </div>

            <button class="enroll-btn" (click)="enrollInCourse()">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polygon points="5 3 19 12 5 21 5 3" />
              </svg>
              Comenzar Curso
            </button>
          </div>

          <div class="hero-video">
            <div class="video-container">
              <img [src]="course!.thumbnail" [alt]="course!.title" class="video-thumbnail" />
              <div class="video-overlay">
                <button class="video-play-btn">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="white">
                    <polygon points="5 3 19 12 5 21 5 3" />
                  </svg>
                </button>
                <span class="video-label">Vista previa del curso</span>
              </div>
            </div>
            <div class="video-features">
              <div class="feature-item">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                  <polyline points="22 4 12 14.01 9 11.01" />
                </svg>
                <span>Acceso de por vida</span>
              </div>
              <div class="feature-item">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <rect x="2" y="7" width="20" height="15" rx="2" ry="2" />
                  <polyline points="17 2 12 7 7 2" />
                </svg>
                <span>Certificado al finalizar</span>
              </div>
              <div class="feature-item">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                  <polyline points="7 10 12 15 17 10" />
                  <line x1="12" y1="15" x2="12" y2="3" />
                </svg>
                <span>Recursos descargables</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- What You'll Learn -->
      <section class="learning-section section-card">
        <h2 class="section-title">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="20 6 9 17 4 12" />
          </svg>
          Lo que aprenderás
        </h2>
        <div class="learning-grid">
          <div
            class="learning-item"
            *ngFor="let item of course!.learningPoints; let i = index"
            [style.animation-delay.ms]="i * 50"
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="20 6 9 17 4 12" />
            </svg>
            <span>{{ item }}</span>
          </div>
        </div>
      </section>

      <!-- Modules Section -->
      <section class="modules-section section-card">
        <div class="section-header">
          <h2 class="section-title">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
              <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
            </svg>
            Contenido del Curso
          </h2>
          <div class="modules-summary">
            <span>{{ course!.modules!.length }} módulos</span>
            <span>•</span>
            <span>{{ getTotalLessons() }} clases</span>
            <span>•</span>
            <span>{{ course!.duration }}</span>
          </div>
        </div>

        <div class="modules-list">
          <div
            class="module-item"
            *ngFor="let module of course!.modules; let i = index"
            [style.animation-delay.ms]="i * 100"
          >
            <div class="module-header" (click)="toggleModule(i)">
              <div class="module-info">
                <div class="module-number">Módulo {{ i + 1 }}</div>
                <h3 class="module-title">{{ module.title }}</h3>
                <div class="module-meta">
                  <span class="module-lessons">{{ module.topics.length }} temas</span>
                  <span>•</span>
                  <span class="module-duration">{{ module.duration }}</span>
                  <span>•</span>
                  <span class="module-points">
                    <svg
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <circle cx="12" cy="12" r="10" />
                    </svg>
                    {{ module.points }} puntos
                  </span>
                </div>
              </div>
              <div class="module-toggle">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  [class.rotated]="expandedModules[i]"
                >
                  <polyline points="6 9 12 15 18 9" />
                </svg>
              </div>
            </div>

            <div class="module-content" *ngIf="expandedModules[i]">
              <div class="topics-list">
                <div class="topic-item" *ngFor="let topic of module.topics; let j = index">
                  <div class="topic-header" (click)="toggleTopic(i, j)">
                    <div class="topic-info">
                      <svg
                        class="topic-icon"
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                      </svg>
                      <span class="topic-title">{{ topic.title }}</span>
                    </div>
                    <div class="topic-meta">
                      <span class="topic-lessons">{{ topic.lessons.length }} clases</span>
                      <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        [class.rotated]="expandedTopics[i]?.[j]"
                      >
                        <polyline points="6 9 12 15 18 9" />
                      </svg>
                    </div>
                  </div>

                  <div class="lessons-list" *ngIf="expandedTopics[i]?.[j]">
                    <div class="lesson-item" *ngFor="let lesson of topic.lessons">
                      <div class="lesson-icon">
                        <svg
                          width="16"
                          height="16"
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                        >
                          <polygon points="5 3 19 12 5 21 5 3" />
                        </svg>
                      </div>
                      <span class="lesson-title">{{ lesson.title }}</span>
                      <span class="lesson-duration">{{ lesson.duration }}</span>
                      <span class="lesson-preview" *ngIf="lesson.isPreview">Vista previa</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Requirements -->
      <section class="requirements-section section-card">
        <h2 class="section-title">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
            <polyline points="14 2 14 8 20 8" />
            <line x1="16" y1="13" x2="8" y2="13" />
            <line x1="16" y1="17" x2="8" y2="17" />
            <polyline points="10 9 9 9 8 9" />
          </svg>
          Requisitos
        </h2>
        <ul class="requirements-list">
          <li
            *ngFor="let req of course!.requirements; let i = index"
            [style.animation-delay.ms]="i * 50"
          >
            {{ req }}
          </li>
        </ul>
      </section>

      <!-- Reviews Section -->
      <section class="reviews-section section-card">
        <h2 class="section-title">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polygon
              points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
            />
          </svg>
          Reseñas de Estudiantes
        </h2>

        <div class="reviews-summary">
          <div class="rating-overview">
            <div class="rating-big">{{ course!.rating }}</div>
            <div class="stars-display">
              <svg
                *ngFor="let star of [1, 2, 3, 4, 5]"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                [attr.fill]="star <= course!.rating! ? '#fbbf24' : 'none'"
                stroke="#fbbf24"
                stroke-width="2"
              >
                <polygon
                  points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
                />
              </svg>
            </div>
          </div>

          <div class="rating-bars">
            <div class="rating-bar-item" *ngFor="let rating of ratingDistribution">
              <span class="rating-label">{{ rating.stars }} ⭐</span>
              <div class="rating-bar-container">
                <div class="rating-bar-fill" [style.width.%]="rating.percentage"></div>
              </div>
              <span class="rating-percentage">{{ rating.percentage }}%</span>
            </div>
          </div>
        </div>

        <div class="reviews-list">
          <div
            class="review-card"
            *ngFor="let review of course!.reviewsList; let i = index"
            [style.animation-delay.ms]="i * 100"
          >
            <div class="review-header">
              <img [src]="review.userAvatar" [alt]="review.userName" class="review-avatar" />
              <div class="review-user-info">
                <span class="review-user-name">{{ review.userName }}</span>
                <div class="review-meta">
                  <div class="review-stars">
                    <svg
                      *ngFor="let star of [1, 2, 3, 4, 5]"
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      [attr.fill]="star <= review.rating ? '#fbbf24' : 'none'"
                      stroke="#fbbf24"
                      stroke-width="2"
                    >
                      <polygon
                        points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
                      />
                    </svg>
                  </div>
                  <span class="review-date">{{ review.date }}</span>
                </div>
              </div>
            </div>
            <p class="review-text">{{ review.comment }}</p>
            <div class="review-helpful">
              <button class="helpful-btn">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"
                  />
                </svg>
                Útil ({{ review.helpful }})
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Related Courses -->
      <section class="related-section">
        <h2 class="section-title">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
          </svg>
          Cursos Relacionados
        </h2>

        <div class="related-scroll-container">
          <div class="related-courses-grid">
            <div
              class="related-course-card"
              *ngFor="let relatedCourse of relatedCourses; let i = index"
              [style.animation-delay.ms]="i * 80"
            >
              <div class="related-course-image">
                <img [src]="relatedCourse!.image" [alt]="relatedCourse!.title" />
                <div class="related-course-overlay">
                  <button class="related-play-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                      <polygon points="5 3 19 12 5 21 5 3" />
                    </svg>
                  </button>
                </div>
              </div>
              <div class="related-course-content">
                <h4 class="related-course-title">{{ relatedCourse!.title }}</h4>
                <div class="related-course-meta">
                  <div class="related-rating">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24">
                      <polygon
                        points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9 27 8.91 8.26 12 2"
                      />
                    </svg>
                    <span>{{ relatedCourse!.rating }}</span>
                  </div>
                  <span class="related-students"
                    >{{ relatedCourse!.students!.toLocaleString() }} estudiantes</span
                  >
                </div>
                <div class="related-course-price">
                  <span class="related-points">{{ relatedCourse!.totalPoints }} CodeCoins</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</div>
